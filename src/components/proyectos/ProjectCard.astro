---
import type { CollectionEntry } from "astro:content";

interface Props {
  proyecto: CollectionEntry<"proyectos">;
  index: number;
}

const { proyecto, index } = Astro.props;

// Helper para formatear fecha
const formatDate = (date: Date) => {
  return new Intl.DateTimeFormat("es-ES", {
    day: "numeric",
    month: "long",
    year: "numeric",
  }).format(date);
};
---

<article
  class="group flex flex-col bg-white rounded-sm shadow-sm hover:shadow-2xl hover:-translate-y-1 transition-all duration-500 border border-zinc-100 overflow-hidden animate-fade-in-up h-full relative"
  style={`animation-delay: ${index * 100}ms`}
  data-date={proyecto.data.fecha.toISOString()}
>
  <div
    class="aspect-[3/2] overflow-hidden bg-zinc-100 relative border-b border-zinc-50 group"
  >
    {/* Floating Date Badge */}
    <div
      class="absolute top-4 left-4 z-10 bg-white/90 backdrop-blur-sm px-3 py-1.5 text-[10px] font-bold uppercase tracking-widest text-zinc-900 shadow-sm border border-white/50 rounded-sm"
    >
      {formatDate(proyecto.data.fecha)}
    </div>

    <img
      src={proyecto.data.imagen || "/no_image.jpg"}
      alt={proyecto.data.titulo}
      class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700 ease-out will-change-transform"
      onerror="this.onerror=null;this.src='/no_image.jpg';"
    />
  </div>

  <div class="p-6 md:p-8 flex flex-col flex-grow relative">
    <h2
      class="text-xl md:text-2xl font-bold text-zinc-900 mb-3 group-hover:text-terracotta-500 transition-colors leading-tight"
    >
      {proyecto.data.titulo}
    </h2>

    <p class="text-zinc-600 leading-relaxed mb-6 text-sm font-light">
      {proyecto.data.descripcion}
    </p>

    <div class="mt-auto pt-4 border-t border-zinc-50">
      {
        proyecto.data.pdf ? (
          <a
            href={proyecto.data.pdf}
            download
            class="inline-flex items-center gap-2 text-xs font-bold uppercase tracking-widest text-zinc-900 border-b-2 border-zinc-200 hover:border-terracotta-500 pb-1 transition-colors"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="2"
              stroke="currentColor"
              class="w-4 h-4"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"
              />
            </svg>
            Descargar PDF
          </a>
        ) : (
          <span class="block h-5" />
        )
      }
    </div>
  </div>
</article>
